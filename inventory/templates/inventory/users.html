{% extends "inventory/base2.html" %}

{% block extraelements %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/bootstrap-table.min.css' %}">

<link  rel="stylesheet" href="{% static 'css/bootstrap-toggle.min.css' %}">

<script src="{% static 'js/bootstrap-toggle.min.js' %}"></script>
<!-- Latest compiled and minified JavaScript -->
<script src="{% static 'js/bootstrap-table.min.js' %}"></script>

<script type="text/javascript" src= "{% static 'users_scripts.js' %}"></script>
<script src="{% static 'js/bootbox.min.js' %}"></script>
   
              
{% endblock extraelements %} 

{% block content %}
<div id="newuserModal" class="modal fade" role="dialog">
    <div class="modal-dialog">

      <!-- Modal content-->
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" onclick="new_user_close()">&times;</button>
            <h4 class="modal-title">Creating New User</h4>
          </div>
          <div class="modal-body">

            {% if group|stringformat:"s" == "head" %}
            User Type:
            <select id="usertype">
              <option value="User Type">User Type</option>
              <option value="head">Head</option>
              <option value="manager">Manager</option>
              <option value="temporary-head">Temporary Head</option>
            </select>
            {% endif %}
            {% if group|stringformat:"s" == "temporary-head" %}
            User Type:
            <select id="usertype">
              <option value="User Type">User Type</option>
              <option value="manager">Manager</option>
              <option value="temporary-head">Temporary Head</option>
            </select>
            {% endif %}
            Email:
            <input id="email" type="text" name="">
            Password:
            <input id="password" type="password" name="">
          </div>
          
          <div class="modal-footer">
            <button type="button" class="btn btn-default" onclick="createuser()">Create</button>
          </div>
        </div>

    </div>
</div>
<button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#newuserModal"> Create New User </button>
<div>
  <p id="error" style="color:red"></p>
  
</div>
<div class="table-responsive">
<table class="table table-stripped" data-toggle="table" id="user_table">
  <thead>
    <tr>
      <th data-sortable="true">First Name</th>
      <th>Last Name</th>
      <th>Email</th>
      <th>Date Joined</th>
      <th>Created By</th>
      <th>Status</th>
      
      
      
    </tr>
  </thead>
  {% for u in user %}

  <tr>
    <td>{{u.first_name}}</td>
    <td>{{u.last_name}}</td>
    <td>{{u.username}}</td>
    <td>{{u.date_joined}}</td>
    <td>{{u.userprofile.created_by}}</td> 
    <td>
    {% if u.is_active|stringformat:"s" == "True" %}
      <input type="checkbox" onchange="changestatus('toggle{{u.id}}')"
      {% if group|stringformat:"s" == "temporary-head" %}
        {% if u.groups.all.0|stringformat:"s" == "head" %}
          disabled
        {% endif %} 
      {% endif %}
      {% if u.username|stringformat:"s" == request.user.username|stringformat:"s" %}
        disabled 
      {% endif %}
      checked id="toggle{{u.id}}" data-on="Active" data-off="Inactive">
    {% else %}
      <input type="checkbox" onchange="changestatus('toggle{{u.id}}')" 
        {% if group|stringformat:"s" == "temporary-head" %}
          {% if u.groups.all.0|stringformat:"s" == "head" %}
            disabled
          {% endif %} 
        {% endif %}
      id="toggle{{u.id}}" data-on="Active" data-off="Inactive">  
    {% endif %}  
    </td>
     

  </tr>
  {% endfor %}
</table>

</div>

<script type="text/javascript">
	$(document).ready(function(){

  $('input[id^="toggle"]').each(function(){
    $('#'+this.id).bootstrapToggle();
    
  });
});
</script>           

{% endblock content %}


